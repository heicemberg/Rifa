(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[192],{8314:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>c});var r=a(5155),l=a(2115),i=a(6874),n=a.n(i),d=a(2099);function c(){let[e,s]=(0,l.useState)("loading"),[a,i]=(0,l.useState)(""),[c,t]=(0,l.useState)({url:"",key:""}),[o,x]=(0,l.useState)(""),[u,m]=(0,l.useState)(!1);(0,l.useEffect)(()=>{t({url:"https://ugmfmnwbynppdzkhvrih.supabase.co",key:"SET"}),(async()=>{try{let e="https://ugmfmnwbynppdzkhvrih.supabase.co";if(!e||e.includes("placeholder")){s("error"),i("Supabase URL not configured properly");return}let{data:a,error:r}=await d.ND.from("customers").select("count").limit(1);if(r)throw r;s("success")}catch(e){s("error"),i(e?.message||"Error desconocido")}})()},[]);let h=async()=>{m(!0),x("Probando inserci\xf3n de datos...");try{let e={nombre:"Usuario Test",apellidos:"Apellido Test",telefono:"+52 55 1234 5678",email:`test${Date.now()}@example.com`,estado:"CDMX",ciudad:"Ciudad de M\xe9xico",cantidad_boletos:1,numeros_boletos:[1001],precio_unitario:10,precio_total:10,metodo_pago:"Binance Pay"},s=await (0,d.ru)(e);x(`✅ \xa1Inserci\xf3n exitosa!
Customer ID: ${s.customer.id}
Purchase ID: ${s.purchase.id}
Email: ${s.customer.email}`)}catch(e){x(`❌ Error al insertar datos:
${e.message}`),console.error("Error completo:",e)}m(!1)},b=async()=>{x("Probando conexi\xf3n detallada...");try{let e=await (0,d.zk)();x(`✅ Conexi\xf3n detallada: ${e?"EXITOSA":"FALLIDA"}`)}catch(e){x(`❌ Error de conexi\xf3n detallada:
${e.message}`)}};return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"\uD83D\uDD27 Diagn\xf3stico de Supabase"}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 mb-6 shadow",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"\uD83D\uDCCB Variables de Entorno"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"SUPABASE_URL:"}),(0,r.jsx)("span",{className:"NOT_SET"===c.url?"text-red-600":"text-green-600",children:"NOT_SET"===c.url?"❌ No configurada":"✅ Configurada"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"SUPABASE_ANON_KEY:"}),(0,r.jsx)("span",{className:"NOT_SET"===c.key?"text-red-600":"text-green-600",children:"NOT_SET"===c.key?"❌ No configurada":"✅ Configurada"})]}),"NOT_SET"!==c.url&&(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-600",children:["URL: ",c.url]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 mb-6 shadow",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"\uD83D\uDD17 Estado de Conexi\xf3n"}),"loading"===e&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-blue-600",children:[(0,r.jsx)("div",{className:"animate-spin w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full"}),"Probando conexi\xf3n..."]}),"success"===e&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,r.jsx)("span",{className:"text-xl",children:"✅"}),"Conexi\xf3n exitosa a Supabase"]}),"error"===e&&(0,r.jsxs)("div",{className:"text-red-600",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("span",{className:"text-xl",children:"❌"}),"Error de conexi\xf3n"]}),(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-3 text-sm",children:[(0,r.jsx)("strong",{children:"Error:"})," ",a]})]})]}),"success"===e&&(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 mb-6 shadow",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"\uD83E\uDDEA Pruebas Adicionales"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("button",{onClick:b,className:"w-full bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors",children:"\uD83D\uDD0D Probar Conexi\xf3n Detallada"}),(0,r.jsx)("button",{onClick:h,disabled:u,className:"w-full bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 disabled:opacity-50 transition-colors",children:u?"⏳ Insertando...":"\uD83D\uDCDD Probar Inserci\xf3n de Datos"})]}),o&&(0,r.jsxs)("div",{className:"mt-4 bg-gray-100 border rounded p-3",children:[(0,r.jsx)("h3",{className:"font-bold mb-2",children:"Resultado:"}),(0,r.jsx)("pre",{className:"text-sm whitespace-pre-wrap",children:o})]})]}),(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4 text-blue-800",children:"\uD83D\uDCA1 Soluciones"}),"NOT_SET"===c.url||"NOT_SET"===c.key?(0,r.jsxs)("div",{className:"text-blue-700",children:[(0,r.jsx)("p",{className:"mb-2",children:"❌ Faltan variables de entorno:"}),(0,r.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[(0,r.jsxs)("li",{children:["Verifica que existe el archivo ",(0,r.jsx)("code",{children:".env.local"})]}),(0,r.jsxs)("li",{children:["Reinicia el servidor con ",(0,r.jsx)("code",{children:"npm run dev"})]}),(0,r.jsx)("li",{children:"Verifica las credenciales en Supabase"})]})]}):"error"===e?(0,r.jsxs)("div",{className:"text-blue-700",children:[(0,r.jsx)("p",{className:"mb-2",children:"\uD83D\uDD27 Para resolver el error de conexi\xf3n:"}),(0,r.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[(0,r.jsx)("li",{children:"Ve a tu panel de Supabase"}),(0,r.jsx)("li",{children:"Ejecuta el script SQL del esquema normalizado"}),(0,r.jsxs)("li",{children:["Verifica que las tablas ",(0,r.jsx)("code",{children:"customers"}),", ",(0,r.jsx)("code",{children:"purchases"})," y ",(0,r.jsx)("code",{children:"tickets"})," existen"]}),(0,r.jsx)("li",{children:"Revisa las pol\xedticas RLS est\xe1n configuradas"})]})]}):(0,r.jsxs)("div",{className:"text-green-700",children:[(0,r.jsx)("p",{children:"\uD83C\uDF89 \xa1Todo est\xe1 funcionando correctamente!"}),(0,r.jsxs)("p",{className:"text-sm mt-2",children:["Puedes volver a la ",(0,r.jsx)(n(),{href:"/",className:"underline",children:"p\xe1gina principal"}),"o ir al ",(0,r.jsx)(n(),{href:"/admin",className:"underline",children:"panel de admin"}),"."]})]})]})]})})}},8701:(e,s,a)=>{Promise.resolve().then(a.bind(a,8314))}},e=>{e.O(0,[354,874,99,441,964,358],()=>e(e.s=8701)),_N_E=e.O()}]);